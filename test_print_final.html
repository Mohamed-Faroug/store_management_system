<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار طباعة الفاتورة النهائي</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        @media print {
            * {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
            }
            
            body {
                font-family: Arial, sans-serif !important;
                font-size: 12px !important;
                line-height: 1.4 !important;
                margin: 0 !important;
                padding: 0 !important;
                background: white !important;
                color: black !important;
            }
            
            body * {
                visibility: hidden;
            }
            
            .printable, .printable * {
                visibility: visible !important;
            }
            
            .printable {
                position: absolute !important;
                left: 0 !important;
                top: 0 !important;
                width: 100% !important;
                margin: 0 !important;
                padding: 20px !important;
                background: white !important;
                color: black !important;
            }
            
            .no-print {
                display: none !important;
            }
            
            .card {
                border: 2px solid #000 !important;
                box-shadow: none !important;
                margin: 0 !important;
                padding: 10px !important;
                page-break-inside: avoid !important;
                background: white !important;
            }
            
            .card-header {
                background-color: #f8f9fa !important;
                border-bottom: 2px solid #000 !important;
                padding: 10px !important;
                margin: 0 !important;
            }
            
            .card-body {
                padding: 15px !important;
                margin: 0 !important;
                background: white !important;
            }
            
            .table {
                border-collapse: collapse !important;
                width: 100% !important;
                margin: 10px 0 !important;
                page-break-inside: avoid !important;
                background: white !important;
            }
            
            .table th, .table td {
                border: 1px solid #000 !important;
                padding: 8px !important;
                text-align: right !important;
                font-size: 11px !important;
                background: white !important;
                color: black !important;
            }
            
            .table th {
                background-color: #f8f9fa !important;
                font-weight: bold !important;
            }
            
            .table-primary {
                background-color: #e9ecef !important;
            }
            
            .text-center {
                text-align: center !important;
            }
            
            .text-end {
                text-align: left !important;
            }
            
            h1, h2, h3, h4, h5, h6 {
                margin: 10px 0 !important;
                page-break-after: avoid !important;
                color: black !important;
            }
            
            p {
                color: black !important;
            }
            
            .row {
                margin: 0 !important;
            }
            
            .col-md-6, .col-md-4, .col-md-3, .col-md-2, .col-md-1 {
                float: left !important;
                width: 50% !important;
            }
            
            .col-md-6:nth-child(2) {
                width: 50% !important;
            }
            
            .mb-4 {
                margin-bottom: 20px !important;
            }
            
            .mt-4 {
                margin-top: 20px !important;
            }
            
            .py-2 {
                padding: 5px 0 !important;
            }
            
            .alert {
                border: 1px solid #000 !important;
                padding: 10px !important;
                margin: 10px 0 !important;
            }
            
            .alert-warning {
                background-color: #fff3cd !important;
            }
            
            .btn {
                display: none !important;
            }
            
            hr {
                border: 2px solid #000 !important;
                margin: 20px 0 !important;
            }
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card shadow-sm">
                    <div class="card-header no-print">
                        <h5 class="mb-0">فاتورة رقم: POS-000123</h5>
                        <small class="text-muted">تاريخ الإنشاء: 2025-01-09 10:30:00</small>
                    </div>
                    <div class="card-body printable">
                        <!-- Print Header -->
                        <div class="text-center mb-4" id="printHeader" style="display: none;">
                            <h2 class="fw-bold">فاتورة مبيعات</h2>
                            <h4>رقم الفاتورة: POS-000123</h4>
                            <p>تاريخ: 2025-01-09 10:30:00</p>
                            <hr style="border: 2px solid #000; margin: 20px 0;">
                        </div>
                        
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <h6>بيانات العميل:</h6>
                                <p><strong>الاسم:</strong> عميل نقدي</p>
                                <p><strong>الهاتف:</strong> -</p>
                            </div>
                            <div class="col-md-6">
                                <h6>بيانات الفاتورة:</h6>
                                <p><strong>طريقة الدفع:</strong> نقدي</p>
                                <p><strong>أنشأها:</strong> admin</p>
                            </div>
                        </div>
                        
                        <h6>الأصناف:</h6>
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>الصنف</th>
                                    <th>الكمية</th>
                                    <th>السعر</th>
                                    <th>المجموع</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>إطار ميشلان</td>
                                    <td>2</td>
                                    <td>75.00 ج.س</td>
                                    <td>150.00 ج.س</td>
                                </tr>
                                <tr>
                                    <td>مرايا جانبية</td>
                                    <td>1</td>
                                    <td>50.00 ج.س</td>
                                    <td>50.00 ج.س</td>
                                </tr>
                                <tr>
                                    <td>غطاء مقعد</td>
                                    <td>1</td>
                                    <td>100.00 ج.س</td>
                                    <td>100.00 ج.س</td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="3"><strong>المجموع الفرعي:</strong></td>
                                    <td><strong>300.00 ج.س</strong></td>
                                </tr>
                                <tr>
                                    <td colspan="3"><strong>الخصم:</strong></td>
                                    <td><strong>-10.00 ج.س</strong></td>
                                </tr>
                                <tr>
                                    <td colspan="3"><strong>الضريبة:</strong></td>
                                    <td><strong>15.00 ج.س</strong></td>
                                </tr>
                                <tr class="table-primary">
                                    <td colspan="3"><strong>المجموع النهائي:</strong></td>
                                    <td><strong>305.00 ج.س</strong></td>
                                </tr>
                            </tfoot>
                        </table>
                        
                        <div class="mt-4 d-flex gap-2 no-print">
                            <button class="btn btn-primary" onclick="printInvoice()">طباعة الفاتورة</button>
                            <button class="btn btn-secondary" onclick="testPrint()">اختبار الطباعة</button>
                            <button class="btn btn-info" onclick="showPrintPreview()">معاينة الطباعة</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function printInvoice() {
            console.log('Starting print process...');
            
            // Show print header
            const printHeader = document.getElementById('printHeader');
            if (printHeader) {
                printHeader.style.display = 'block';
                console.log('Print header shown');
            }
            
            // Wait a moment for the header to show
            setTimeout(() => {
                console.log('Printing...');
                window.print();
                
                // Hide print header after printing
                setTimeout(() => {
                    if (printHeader) {
                        printHeader.style.display = 'none';
                        console.log('Print header hidden');
                    }
                }, 1000);
            }, 100);
        }
        
        function testPrint() {
            console.log('Testing print styles...');
            
            // Show print header
            const printHeader = document.getElementById('printHeader');
            if (printHeader) {
                printHeader.style.display = 'block';
            }
            
            // Apply print styles temporarily
            document.body.style.fontSize = '12px';
            document.body.style.fontFamily = 'Arial, sans-serif';
            document.body.style.background = 'white';
            document.body.style.color = 'black';
            
            alert('تم تطبيق تنسيقات الطباعة. جرب الطباعة الآن!');
        }
        
        function showPrintPreview() {
            console.log('Showing print preview...');
            
            // Show print header
            const printHeader = document.getElementById('printHeader');
            if (printHeader) {
                printHeader.style.display = 'block';
            }
            
            // Apply print styles temporarily
            document.body.style.fontSize = '12px';
            document.body.style.fontFamily = 'Arial, sans-serif';
            document.body.style.background = 'white';
            document.body.style.color = 'black';
            
            // Show preview
            const printable = document.querySelector('.printable');
            if (printable) {
                printable.style.position = 'relative';
                printable.style.background = 'white';
                printable.style.color = 'black';
                printable.style.border = '2px solid #000';
                printable.style.padding = '20px';
            }
            
            alert('تم تطبيق معاينة الطباعة. تحقق من المحتوى!');
        }
    </script>
</body>
</html>
